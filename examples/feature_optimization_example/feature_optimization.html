<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>&lt;no title&gt; &mdash; libemg 2.0.0 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> libemg
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../documentation/introduction/introduction.html">Introduction</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Modules:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../documentation/data/data.html">Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../documentation/filtering/filtering.html">Filtering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../documentation/features/features.html">Feature Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../documentation/feature_selection/feature_selection.html">Feature Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../documentation/prediction/prediction.html">EMG Prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../documentation/evaluation/evaluation.html">Evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../documentation/animation/animation.html">Animation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tools:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../documentation/screen_guided_training/sgt.html">Screen Guided Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../documentation/supported_hardware/supported_hardware.html">Supported Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../documentation/visualization/visualization.html">Visualizations</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../emg_toolbox.html">Data Handler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../emg_toolbox.html#module-libemg.datasets">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../emg_toolbox.html#module-libemg.filtering">Filtering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../emg_toolbox.html#module-libemg.feature_extractor">Feature Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../emg_toolbox.html#module-libemg.feature_selector">Feature Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../emg_toolbox.html#module-libemg.emg_predictor">EMG Prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../emg_toolbox.html#module-libemg.offline_metrics">Offline Evaluation Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../emg_toolbox.html#module-libemg.utils">Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../emg_toolbox.html#module-libemg.streamers">Streamers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../emg_toolbox.html#module-libemg.gui">Screen Guided Training</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Offline Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../simple_offline_example/simple_offline_example.html">Simple Offline Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features_and_group_example/features_and_group_example.html">Exploring Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="feature_optimization_example.html">Optimizing Feature Params</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deep_learning_example/deep_learning_example.html">Deep Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../offline_regression_example/offline_regression_example.html">Offline Regression Analysis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Online Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../snake_example/snake_example.html">Continuous Control (Snake)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unity_example/unity_example.html">Cross Platform Control (Unity)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mouse_example/mouse_example.html">Proportional Control (Mouse Interface)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mixed_reality_example/mixed_reality_example.html">Mixed Reality (Hololens 2)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fitts_example/fitts_example.html">Online Evaluation (Iso Fitts)</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">libemg</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>&lt;no title&gt;</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/libemg/libemg/blob/main/docs/source/examples/feature_optimization_example/feature_optimization.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p><a class="reference external" href="https://github.com/libemg/LibEMG_FeatureOptimization_Showcase">View Source Code</a></p>
<style>
    .center {
        display: block;
        margin-left: auto;
        margin-right: auto;
        width: 50%;
    }
</style>
<p>Although we provide default values for various tunable parameters within the feature extraction module, we highly recommend optimizing these parameters to give the best performance for your specific project. There are a number of influences that change project to project that can influence the optimal parameters involved in feature extraction. The hardware of your project could result in the default values being suboptimal, for instance, instrumentation amplifiers change the scale of the signal and the sampling rate determines what frequency bands are available to capture information from. For different gesture sets, you may want to increase or decrease sensitivity of features (for instance by tuning the Willison’s amplitude threshold). There are also numerous other factors you’d like to be robust to and various features have their own sensitivity parameters that can minimize how much of this exogenous variability is captured. For all these reasons, we are providing a simple walkthrough that shows how you can optimize the parameters going into the feature extraction functions.</p>
<p>In this example, we will be determining the best Willison’s amplitude threshold for a single subject of the 3DCDataset. Let’s first prepare the dataset, using the same procedure as prior examples. First, load in the dataset and load it into an OfflineDataHandler. Next, separate the subject’s data into an optimization set and a testing set. The analysis set will be split into a training and validation set using the first 3 reps for the training set and the final rep for the validation set. The remaining 4 reps will held-out of the optimization process and used for the testing set.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s load in a single subject&#39;s worth of data to illustrate the process</span>
<span class="c1"># of finding the best feature parameter</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">libemg</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">_3DCDataset</span><span class="p">()</span>
<span class="n">odh</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">prepare_data</span><span class="p">(</span><span class="n">subjects</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="c1"># For this process, lets split the dataset into training and testing sets using the </span>
<span class="c1"># &quot;sets&quot; metadata tag.</span>
<span class="n">training_odh</span> <span class="o">=</span> <span class="n">odh</span><span class="p">[</span><span class="s1">&#39;Train&#39;</span><span class="p">]</span>
<span class="n">test_odh</span> <span class="o">=</span> <span class="n">odh</span><span class="p">[</span><span class="s1">&#39;Test&#39;</span><span class="p">]</span>
<span class="c1"># For the feature parameter optimization, let further split the training dataset into a </span>
<span class="c1"># &quot;train&quot; and &quot;validation&quot; set using the first three reps for training and the final rep</span>
<span class="c1"># for validation. </span>
<span class="n">valid_odh</span>  <span class="o">=</span> <span class="n">training_odh</span><span class="o">.</span><span class="n">isolate_data</span><span class="p">(</span><span class="s2">&quot;reps&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">train_odh</span>  <span class="o">=</span> <span class="n">training_odh</span><span class="o">.</span><span class="n">isolate_data</span><span class="p">(</span><span class="s2">&quot;reps&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="c1"># Given that these are stored data from as Thalmic labs myoarmband, lets use a window size of</span>
<span class="c1"># 50 samples and an increment of 10 samples.</span>
<span class="n">valid_windows</span><span class="p">,</span> <span class="n">valid_metadata</span> <span class="o">=</span> <span class="n">valid_odh</span><span class="o">.</span><span class="n">parse_windows</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">train_windows</span><span class="p">,</span> <span class="n">train_metadata</span> <span class="o">=</span> <span class="n">train_odh</span><span class="o">.</span><span class="n">parse_windows</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>Although we could define a large search space around a reasonable region, we can get a good idea of potential values for thresholds by visual inspection. Willison’s amplitude computed the number of times the magnitude of the derivative exceeds a certain value. We can quickly visualize the distribution of the absolute value of the derivative to and see what a reasonable test range would be.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Taking a look a the range of the EMG signals of the _3DCDataset, these seem to be </span>
<span class="c1"># integer values. Let&#39;s quickly get an idea of what may be the appropriate range to </span>
<span class="c1"># test for the WAMP threshold by inspecting the train_odh.</span>
<span class="n">derivatives</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">train_odh</span><span class="o">.</span><span class="n">data</span><span class="p">[:]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">derivatives</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><img alt="" src="../../_images/derivative_values.png" /></p>
<p>From this visualization, it looks like a reasonable range for thresholds is 0-2000. We can define those test points using np.linspace.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lets initialize a grid search within that range.</span>
<span class="n">test_points</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">threshold_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">test_points</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we can finally begin iterating through assessing the accuracy of these test thresholds! We will prepare the feature extractor object and offline metrics object from libemg. Then in a loop, we will extract train and validation features using our test value for the WAMP threshold.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Begin computing the feature accuracies</span>
<span class="n">fe</span> <span class="o">=</span> <span class="n">libemg</span><span class="o">.</span><span class="n">feature_extractor</span><span class="o">.</span><span class="n">FeatureExtractor</span><span class="p">()</span>
<span class="n">om</span> <span class="o">=</span> <span class="n">libemg</span><span class="o">.</span><span class="n">offline_metrics</span><span class="o">.</span><span class="n">OfflineMetrics</span><span class="p">()</span>
<span class="k">for</span> <span class="n">tp</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">test_points</span><span class="p">):</span>
    <span class="c1"># using a dictionary with &quot;WAMP_threshold&quot; keyword to specify the test point</span>
    <span class="n">dic</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;WAMP_threshold&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">threshold_values</span><span class="p">[</span><span class="n">tp</span><span class="p">])</span>
    <span class="p">}</span>
    <span class="n">train_features</span> <span class="o">=</span> <span class="n">fe</span><span class="o">.</span><span class="n">extract_features</span><span class="p">([</span><span class="s2">&quot;WAMP&quot;</span><span class="p">],</span> <span class="n">train_windows</span><span class="p">,</span> <span class="n">dic</span><span class="p">)</span>
    <span class="n">valid_features</span> <span class="o">=</span> <span class="n">fe</span><span class="o">.</span><span class="n">extract_features</span><span class="p">([</span><span class="s2">&quot;WAMP&quot;</span><span class="p">],</span> <span class="n">valid_windows</span><span class="p">,</span> <span class="n">dic</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">libemg</span><span class="o">.</span><span class="n">emg_predictor</span><span class="o">.</span><span class="n">EMGClassifier</span><span class="p">(</span><span class="s2">&quot;LDA&quot;</span><span class="p">)</span>
    <span class="n">feature_dictionary</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;training_features&quot;</span><span class="p">:</span> <span class="n">train_features</span><span class="p">,</span>
                            <span class="s2">&quot;training_labels&quot;</span><span class="p">:</span>   <span class="n">train_metadata</span><span class="p">[</span><span class="s2">&quot;classes&quot;</span><span class="p">]}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># If we use a try block, we don&#39;t need to worry about non-invertable matrices</span>
        <span class="c1"># The results would just stay 0 as initialized.</span>
        <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">feature_dictionary</span> <span class="o">=</span> <span class="n">feature_dictionary</span><span class="p">)</span>
        <span class="n">predictions</span><span class="p">,</span> <span class="n">probabilties</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">valid_features</span><span class="p">)</span>
        <span class="n">threshold_results</span><span class="p">[</span><span class="n">tp</span><span class="p">]</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">get_CA</span><span class="p">(</span><span class="n">valid_metadata</span><span class="p">[</span><span class="s2">&quot;classes&quot;</span><span class="p">],</span> <span class="n">predictions</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="k">continue</span>
</pre></div>
</div>
<p>And we can visualize the results for each of our test points to determine the best threshold value.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the accuracies vs the thresholds</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">threshold_values</span><span class="p">,</span> <span class="n">threshold_results</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">best_threshold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">threshold_results</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">threshold_values</span><span class="p">[</span><span class="n">best_threshold</span><span class="p">],</span> <span class="n">threshold_results</span><span class="p">[</span><span class="n">best_threshold</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;WAMP Threshold&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Accuracy (%)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">threshold_values</span><span class="p">[</span><span class="n">best_threshold</span><span class="p">],</span><span class="n">threshold_results</span><span class="p">[</span><span class="n">best_threshold</span><span class="p">],</span> <span class="s2">&quot;(</span><span class="si">{:.2f}</span><span class="s2">, </span><span class="si">{:.2f}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">threshold_values</span><span class="p">[</span><span class="n">best_threshold</span><span class="p">],</span><span class="n">threshold_results</span><span class="p">[</span><span class="n">best_threshold</span><span class="p">]</span> <span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><img alt="" src="../../_images/wamp_ROC.png" /></p>
<p>From this figure, we have found that the best threshold value is 92. We can now use this value on our held-out test set.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now let&#39;s apply this on our test set:</span>
<span class="n">dic</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;WAMP_threshold&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">threshold_values</span><span class="p">[</span><span class="n">best_threshold</span><span class="p">])</span>
    <span class="p">}</span>
<span class="c1"># Quick reminder: train_odh refers to the combined &quot;train&quot; and validation set</span>
<span class="n">train_windows</span><span class="p">,</span> <span class="n">train_metadata</span> <span class="o">=</span> <span class="n">training_odh</span><span class="o">.</span><span class="n">parse_windows</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
<span class="n">test_windows</span><span class="p">,</span> <span class="n">test_metadata</span>   <span class="o">=</span> <span class="n">test_odh</span><span class="o">.</span><span class="n">parse_windows</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
<span class="n">train_features</span> <span class="o">=</span> <span class="n">fe</span><span class="o">.</span><span class="n">extract_features</span><span class="p">([</span><span class="s2">&quot;WAMP&quot;</span><span class="p">],</span> <span class="n">train_windows</span><span class="p">,</span> <span class="n">dic</span><span class="p">)</span>
<span class="n">test_features</span>  <span class="o">=</span> <span class="n">fe</span><span class="o">.</span><span class="n">extract_features</span><span class="p">([</span><span class="s2">&quot;WAMP&quot;</span><span class="p">],</span> <span class="n">test_windows</span><span class="p">,</span> <span class="n">dic</span><span class="p">)</span>
<span class="n">feature_dictionary</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;training_features&quot;</span><span class="p">:</span> <span class="n">train_features</span><span class="p">,</span>
                        <span class="s2">&quot;training_labels&quot;</span><span class="p">:</span>   <span class="n">train_metadata</span><span class="p">[</span><span class="s2">&quot;classes&quot;</span><span class="p">]}</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">libemg</span><span class="o">.</span><span class="n">emg_predictor</span><span class="o">.</span><span class="n">EMGClassifier</span><span class="p">(</span><span class="s2">&quot;LDA&quot;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(,</span> <span class="n">feature_dictionary</span> <span class="o">=</span> <span class="n">feature_dictionary</span><span class="p">)</span>
<span class="n">predictions</span><span class="p">,</span> <span class="n">probabilties</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">test_features</span><span class="p">)</span>
<span class="n">test_accuracy</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">get_CA</span><span class="p">(</span><span class="n">test_metadata</span><span class="p">[</span><span class="s2">&quot;classes&quot;</span><span class="p">],</span> <span class="n">predictions</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> 

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test accuracy with optimal WAMP threshold: </span><span class="si">{:.2f}</span><span class="s2">%&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">test_accuracy</span><span class="p">))</span>
</pre></div>
</div>
<p>Test accuracy with optimal WAMP threshold: 84.30%.</p>
<p>We now have completed the whole process of determining the best parameter for a tunable feature extraction method and shown how to install it for a held-out test set. This process is not very computationally expensive (as it can be done in minutes on pilot data), but does yield a meaningful improvement in the expected performance of the model. In this example, we used the classification accuracy offline metric to determine what threshold was best, but this could be substituted for any metric the pipeline designer wishes to optimize. The metric being optimized can enforce different behaviours. For instance, we maximized classification accuracy should result in a model that performs best across all classes. However, if minimal active error was used as the optimization goal, incorrect predictions of active motion classes would have been silenced whenever possible. The notion that the metric being optimized influences the feel of the system is also an important consideration when running feature selection.</p>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>